{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h3 class="card-title">
                            <i class="fas fa-chart-line mr-2"></i>
                            {{ trans('learning_progress', default='Learning Progress') }}
                        </h3>
                        <a href="{{ url_for('education.education_home') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left mr-1"></i>{{ trans('back_to_education', default='Back to Education') }}
                        </a>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card bg-primary text-white">
                                <div class="card-body text-center">
                                    <i class="fas fa-book fa-3x mb-3"></i>
                                    <h4>{{ viewed_modules }}</h4>
                                    <p class="mb-0">{{ trans('modules_viewed', default='Modules Viewed') }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-success text-white">
                                <div class="card-body text-center">
                                    <i class="fas fa-percentage fa-3x mb-3"></i>
                                    <h4>{{ "%.1f"|format(progress_percentage) }}%</h4>
                                    <p class="mb-0">{{ trans('completion_rate', default='Completion Rate') }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-info text-white">
                                <div class="card-body text-center">
                                    <i class="fas fa-trophy fa-3x mb-3"></i>
                                    <h4>{{ total_modules }}</h4>
                                    <p class="mb-0">{{ trans('total_modules', default='Total Modules') }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">{{ trans('overall_progress', default='Overall Progress') }}</h5>
                                </div>
                                <div class="card-body">
                                    <div class="progress mb-3" style="height: 25px;">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: {{ progress_percentage }}%" aria-valuenow="{{ progress_percentage }}" aria-valuemin="0" aria-valuemax="100">
                                            {{ "%.1f"|format(progress_percentage) }}%
                                        </div>
                                    </div>
                                    <p class="text-muted mb-0">{{ trans('progress_description', default='You have completed') }} {{ viewed_modules }} {{ trans('out_of', default='out of') }} {{ total_modules }} {{ trans('available_modules', default='available modules') }}.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    {% if progress_records %}
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">{{ trans('module_history', default='Module History') }}</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>{{ trans('module', default='Module') }}</th>
                                                    <th>{{ trans('last_viewed', default='Last Viewed') }}</th>
                                                    <th>{{ trans('total_views', default='Total Views') }}</th>
                                                    <th>{{ trans('status', default='Status') }}</th>
                                                    <th>{{ trans('actions', default='Actions') }}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for record in progress_records %}
                                                <tr>
                                                    <td>
                                                        <strong>{{ record.module_id|title|replace('_', ' ') }}</strong>
                                                    </td>
                                                    <td>
                                                        {% if record.last_viewed %}
                                                            {{ record.last_viewed.strftime('%B %d, %Y at %I:%M %p') }}
                                                        {% else %}
                                                            <span class="text-muted">{{ trans('never', default='Never') }}</span>
                                                        {% endif %}
                                                    </td>
                                                    <td>
                                                        <span class="badge badge-info">{{ record.total_views or 0 }}</span>
                                                    </td>
                                                    <td>
                                                        {% if record.completed %}
                                                            <span class="badge badge-success">
                                                                <i class="fas fa-check mr-1"></i>{{ trans('completed', default='Completed') }}
                                                            </span>
                                                        {% else %}
                                                            <span class="badge badge-warning">
                                                                <i class="fas fa-clock mr-1"></i>{{ trans('in_progress', default='In Progress') }}
                                                            </span>
                                                        {% endif %}
                                                    </td>
                                                    <td>
                                                        <a href="{{ url_for('education.view_module', module_id=record.module_id) }}" class="btn btn-sm btn-outline-primary">
                                                            <i class="fas fa-eye mr-1"></i>{{ trans('view', default='View') }}
                                                        </a>
                                                    </td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <div class="row">
                        <div class="col-12">
                            <div class="alert alert-info text-center">
                                <i class="fas fa-info-circle fa-3x mb-3"></i>
                                <h5>{{ trans('no_progress_yet', default='No Progress Yet') }}</h5>
                                <p class="mb-3">{{ trans('start_learning_message', default='You haven\'t started any modules yet. Begin your tax education journey today!') }}</p>
                                <a href="{{ url_for('education.education_home') }}" class="btn btn-primary">
                                    <i class="fas fa-play mr-2"></i>{{ trans('start_learning', default='Start Learning') }}
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <h5><i class="fas fa-lightbulb mr-2"></i>{{ trans('learning_tips', default='Learning Tips') }}</h5>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <ul class="mb-0">
                                                <li>{{ trans('tip_consistent', default='Set aside time for consistent learning') }}</li>
                                                <li>{{ trans('tip_notes', default='Take notes while reading modules') }}</li>
                                                <li>{{ trans('tip_practice', default='Apply concepts to your business') }}</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <ul class="mb-0">
                                                <li>{{ trans('tip_calculator', default='Use the tax calculator to practice') }}</li>
                                                <li>{{ trans('tip_glossary', default='Reference the glossary for terms') }}</li>
                                                <li>{{ trans('tip_complete', default='Mark modules as complete when finished') }}</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-4">
                            <div class="card border-primary">
                                <div class="card-body text-center">
                                    <i class="fas fa-graduation-cap fa-2x text-primary mb-3"></i>
                                    <h6>{{ trans('continue_learning', default='Continue Learning') }}</h6>
                                    <a href="{{ url_for('education.education_home') }}" class="btn btn-outline-primary btn-sm">{{ trans('browse_modules', default='Browse Modules') }}</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card border-success">
                                <div class="card-body text-center">
                                    <i class="fas fa-calculator fa-2x text-success mb-3"></i>
                                    <h6>{{ trans('practice_calculations', default='Practice Calculations') }}</h6>
                                    <a href="{{ url_for('tax.tax_calculator') }}" class="btn btn-outline-success btn-sm">{{ trans('tax_calculator', default='Tax Calculator') }}</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card border-info">
                                <div class="card-body text-center">
                                    <i class="fas fa-search fa-2x text-info mb-3"></i>
                                    <h6>{{ trans('find_topics', default='Find Specific Topics') }}</h6>
                                    <a href="{{ url_for('education.search') }}" class="btn btn-outline-info btn-sm">{{ trans('search_education', default='Search Education') }}</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}
